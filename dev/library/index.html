<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library · Bifurcation Analysis of DDEs in Julia</title><meta name="title" content="Library · Bifurcation Analysis of DDEs in Julia"/><meta property="og:title" content="Library · Bifurcation Analysis of DDEs in Julia"/><meta property="twitter:title" content="Library · Bifurcation Analysis of DDEs in Julia"/><meta name="description" content="Documentation for Bifurcation Analysis of DDEs in Julia."/><meta property="og:description" content="Documentation for Bifurcation Analysis of DDEs in Julia."/><meta property="twitter:description" content="Documentation for Bifurcation Analysis of DDEs in Julia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Bifurcation Analysis of DDEs in Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bifurcation Analysis of DDEs in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorials/tutorials/">Tutorials</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../BifProblem/">Bifurcation Problem</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitCollocation/">Collocation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Functionalities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Bifurcations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../detectionBifurcation/">Bifurcation detection (codim 1)</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation (codim 2)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Normal form</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simplebp/">Simple branch point</a></li><li><a class="tocitem" href="../nonsimplebp/">Non-simple branch point</a></li><li><a class="tocitem" href="../simplehopf/">Simple Hopf</a></li><li><span class="tocitem">Normal form (periodic orbit)</span></li></ul></li><li><a class="tocitem" href="../branchswitching/">Branch switching</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Options</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../eigensolver/">Eigen Solvers</a></li></ul></li><li><span class="tocitem">Contributing</span></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li class="is-active"><a class="tocitem" href>Library</a><ul class="internal"><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Problems"><span>Problems</span></a></li><li><a class="tocitem" href="#Eigen-solvers"><span>Eigen solvers</span></a></li><li><a class="tocitem" href="#Branch-switching-(branch-point)"><span>Branch switching (branch point)</span></a></li><li><a class="tocitem" href="#Branch-switching-(Hopf-point)"><span>Branch switching (Hopf point)</span></a></li><li><a class="tocitem" href="#Utils-for-periodic-orbits"><span>Utils for periodic orbits</span></a></li><li><a class="tocitem" href="#Misc."><span>Misc.</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bifurcationkit/DDEBifurcationKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bifurcationkit/DDEBifurcationKit.jl/blob/main/docs/src/library.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Library"><a class="docs-heading-anchor" href="#Library">Library</a><a id="Library-1"></a><a class="docs-heading-anchor-permalink" href="#Library" title="Permalink"></a></h1><ul><li><a href="#Library">Library</a></li><li class="no-marker"><ul><li><a href="#Parameters">Parameters</a></li><li><a href="#Problems">Problems</a></li><li><a href="#Eigen-solvers">Eigen solvers</a></li><li><a href="#Branch-switching-(branch-point)">Branch switching (branch point)</a></li><li><a href="#Branch-switching-(Hopf-point)">Branch switching (Hopf point)</a></li><li><a href="#Utils-for-periodic-orbits">Utils for periodic orbits</a></li><li><a href="#Misc.">Misc.</a></li></ul></li></ul><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BifurcationKit.NewtonPar" href="#BifurcationKit.NewtonPar"><code>BifurcationKit.NewtonPar</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct NewtonPar{T, L&lt;:BifurcationKit.AbstractLinearSolver, E&lt;:AbstractEigenSolver}</code></pre><p>Returns a variable containing parameters to affect the <code>newton</code> algorithm when solving <code>F(x) = 0</code>.</p><p><strong>Arguments (with default values):</strong></p><ul><li><p><code>tol::Any</code>: absolute tolerance for <code>F(x)</code> Default: 1.0e-12</p></li><li><p><code>max_iterations::Int64</code>: number of Newton iterations Default: 25</p></li><li><p><code>verbose::Bool</code>: display Newton iterations? Default: false</p></li><li><p><code>linsolver::BifurcationKit.AbstractLinearSolver</code>: linear solver, must be <code>&lt;: AbstractLinearSolver</code> Default: DefaultLS()</p></li><li><p><code>eigsolver::AbstractEigenSolver</code>: eigen solver, must be <code>&lt;: AbstractEigenSolver</code> Default: DefaultEig()</p></li><li><p><code>linesearch::Bool</code>: Default: false</p></li><li><p><code>α::Any</code>: Default: convert(typeof(tol), 1.0)</p></li><li><p><code>αmin::Any</code>: Default: convert(typeof(tol), 0.001)</p></li></ul><p><strong>Arguments for line search (Armijo)</strong></p><ul><li><code>linesearch = false</code>: use line search algorithm (i.e. Newton with Armijo&#39;s rule)</li><li><code>α = 1.0</code>: initial value of α (damping) parameter for line search algorithm</li><li><code>αmin  = 0.001</code>: minimal value of the damping <code>alpha</code></li></ul><div class="admonition is-success" id="Mutating-ba352f8b2f6d9bc2"><header class="admonition-header">Mutating<a class="admonition-anchor" href="#Mutating-ba352f8b2f6d9bc2" title="Permalink"></a></header><div class="admonition-body"><p>For performance reasons, we decided to use an immutable structure to hold the parameters. One can use the package <code>Accessors.jl</code> to drastically simplify the mutation of different fields. See the tutorials for examples.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/Newton.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BifurcationKit.ContinuationPar" href="#BifurcationKit.ContinuationPar"><code>BifurcationKit.ContinuationPar</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">options = ContinuationPar(dsmin = 1e-4,...)</code></pre><p>Returns a variable containing parameters to affect the <code>continuation</code> algorithm used to solve <code>F(x, p) = 0</code>.</p><p><strong>Arguments</strong></p><ul><li><code>dsmin, dsmax</code> are the minimum, maximum arclength allowed value. It controls the density of points in the computed branch of solutions.</li><li><code>ds = 0.01</code> is the initial arclength.</li><li><code>p_min, p_max</code> allowed parameter range for <code>p</code></li><li><code>max_steps = 100</code> maximum number of continuation steps</li><li><code>newton_options::NewtonPar</code>: options for the Newton algorithm</li><li><code>save_to_file = false</code>: save to file. A name is automatically generated or can be defined in <a href="#BifurcationKit.continuation-Tuple{BifurcationKit.AbstractBranchResult, Int64, ContinuationPar, BifurcationKit.AbstractPeriodicOrbitProblem}"><code>continuation</code></a>. This requires <code>using JLD2</code>.</li><li><code>save_sol_every_step::Int64 = 0</code> at which continuation steps do we save the current solution</li><li><code>plot_every_step = 10</code> at which continuation steps do we plot the current solution</li></ul><p><strong>Handling eigen elements, their computation is triggered by the argument <code>detect_bifurcation</code> (see below)</strong></p><ul><li><code>nev = 3</code> number of eigenvalues to be computed. It is automatically increased to have at least <code>nev</code> unstable eigenvalues. To be set for proper  bifurcation detection. See <a href="@ref">Detection of bifurcation points of Equilibria</a> for more informations.</li><li><code>save_eig_every_step = 1</code> record eigen vectors every specified steps. <strong>Important</strong> for memory limited resource, <em>e.g.</em> GPU.</li><li><code>save_eigenvectors = true</code> <strong>Important</strong> for memory limited resource, <em>e.g.</em> GPU.</li></ul><p><strong>Handling bifurcation detection</strong></p><ul><li><code>tol_stability = 1e-10</code> lower bound on the real part of the eigenvalues to test for stability of equilibria and periodic orbits</li><li><code>detect_fold = true</code> detect Fold bifurcations? It is a useful option although the detection of Fold is cheap. Indeed, it may happen that there is a lot of Fold points and this can saturate the memory in memory limited devices (e.g. on GPU)</li><li><code>detect_bifurcation::Int</code> ∈ {0, 1, 2, 3} If set to 0, nothing is done. If set to 1, the eigen-elements are computed. If set to 2, the bifurcations points are detected during the continuation run, but not located precisely. If set to 3, a bisection algorithm is used to locate the bifurcations points (slower). The possibility to switch off detection is a useful option. Indeed, it may happen that there are a lot of bifurcation points and this can saturate the memory of memory limited devices (e.g. on GPU)</li><li><code>dsmin_bisection = 1e-16</code> dsmin for the bisection algorithm for locating bifurcation points</li><li><code>n_inversion = 2</code> number of sign inversions in bisection algorithm</li><li><code>max_bisection_steps = 15</code> maximum number of bisection steps</li><li><code>tol_bisection_eigenvalue = 1e-16</code> tolerance on real part of eigenvalue to detect bifurcation points in the bisection steps</li></ul><p><strong>Handling <code>ds</code> adaptation (see <a href="#BifurcationKit.continuation-Tuple{BifurcationKit.AbstractBranchResult, Int64, ContinuationPar, BifurcationKit.AbstractPeriodicOrbitProblem}"><code>continuation</code></a> for more information)</strong></p><ul><li><code>a  = 0.5</code> aggressiveness factor. It is used to adapt <code>ds</code> in order to have a number of newton iterations per continuation step roughly constant. The higher <code>a</code> is, the larger the step size <code>ds</code> is changed at each continuation step.</li></ul><p><strong>Handling event detection</strong></p><ul><li><code>detect_event::Int</code> ∈ {0, 1, 2} If set to 0, nothing is done. If set to 1, the event locations are sought during the continuation run, but not located precisely. If set to 2, a bisection algorithm is used to locate the event (slower).</li><li><code>tol_param_bisection_event = 1e-16</code> tolerance on parameter to locate event</li></ul><p><strong>Misc</strong></p><ul><li><code>η = 150.</code> parameter to estimate tangent at first point with parameter  p₀ + ds / η</li><li><code>detect_loop</code> [WORK IN PROGRESS] detect loops in the branch and stop the continuation</li></ul><div class="admonition is-success" id="Mutating-15aee59612d85611"><header class="admonition-header">Mutating<a class="admonition-anchor" href="#Mutating-15aee59612d85611" title="Permalink"></a></header><div class="admonition-body"><p>For performance reasons, we decided to use an immutable structure to hold the parameters. One can use the package <code>Accessors.jl</code> to drastically simplify the mutation of different fields. See tutorials for more examples.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/ContParameters.jl#L1-L43">source</a></section></article><h2 id="Problems"><a class="docs-heading-anchor" href="#Problems">Problems</a><a id="Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Problems" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DDEBifurcationKit.ConstantDDEBifProblem" href="#DDEBifurcationKit.ConstantDDEBifProblem"><code>DDEBifurcationKit.ConstantDDEBifProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ConstantDDEBifProblem{Tvf, Tdf, Tu, Td, Tp, Tl&lt;:Union{typeof(identity), Nothing, IndexLens, PropertyLens, ComposedFunction}, Tplot, Trec, Tgets, Tδ} &lt;: DDEBifurcationKit.AbstractDDEBifurcationProblem</code></pre><p>Structure to hold the bifurcation problem. If don&#39;t have parameters, you can pass <code>nothing</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>VF::Any</code>: Vector field, typically a <a href="@ref"><code>BifFunction</code></a>. For more information, please look at the website https://bifurcationkit.github.io/DDEBifurcationKit.jl/dev/BifProblem</p></li><li><p><code>delays::Any</code>: function delays. It takes the parameters and return the non-zero delays in an <code>AbstractVector</code> form. Example: <code>delays = par -&gt; [1.]</code></p></li><li><p><code>u0::Any</code>: Initial guess</p></li><li><p><code>delays0::Any</code>: initial delays (set internally by the constructor)</p></li><li><p><code>params::Any</code>: parameters</p></li><li><p><code>lens::Union{typeof(identity), Nothing, IndexLens, PropertyLens, ComposedFunction}</code>: Typically a <code>Accessors.@optic</code>. It specifies which parameter axis among <code>params</code> is used for continuation. For example, if <code>par = (α = 1.0, β = 1)</code>, we can perform continuation w.r.t. <code>α</code> by using <code>lens = (@optic _.α)</code>. If you have an array <code>par = [ 1.0, 2.0]</code> and want to perform continuation w.r.t. the first variable, you can use <code>lens = (@optic _[1])</code>. For more information, we refer to <code>Accessors.jl</code>.</p></li><li><p><code>plotSolution::Any</code>: user function to plot solutions during continuation. Signature: <code>plotSolution(x, p; kwargs...)</code></p></li><li><p><code>recordFromSolution::Any</code>: <code>record_from_solution = (x, p; k...) -&gt; norm(x)</code> function used record a few indicators about the solution. It could be <code>norm</code> or <code>(x, p) -&gt; x[1]</code>. This is also useful when saving several huge vectors is not possible for memory reasons (for example on GPU...). This function can return pretty much everything but you should keep it small. For example, you can do <code>(x, p) -&gt; (x1 = x[1], x2 = x[2], nrm = norm(x))</code> or simply <code>(x, p) -&gt; (sum(x), 1)</code>. This will be stored in <code>contres.branch</code> (see below). Finally, the first component is used to plot in the continuation curve.</p></li><li><p><code>save_solution::Any</code>: function to save the full solution on the branch. Some problem are mutable (like periodic orbit functional with adaptive mesh) and this function allows to save the state of the problem along with the solution itself. Signature <code>save_solution(x, p)</code></p></li><li><p><code>δ::Any</code>: delta for Finite differences</p></li></ul><p><strong>Methods</strong></p><ul><li><code>getu0(pb)</code> calls <code>pb.u0</code></li><li><code>getparams(pb)</code> calls <code>pb.params</code></li><li><code>getlens(pb)</code> calls <code>pb.lens</code></li><li><code>setparam(pb, p0)</code> calls <code>set(pb.params, pb.lens, p0)</code></li><li><code>record_from_solution(pb)</code> calls <code>pb.record_from_solution</code></li></ul><p><strong>Constructors</strong></p><ul><li><code>ConstantDDEBifProblem(F, delays, u0, params, lens; J, Jᵗ, d2F, d3F, kwargs...)</code> and <code>kwargs</code> are the fields above.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/DDEBifurcationKit.jl/blob/f71a9db0d86172ad0d8e44f83e0654ac5b8889c0/src/Problems.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DDEBifurcationKit.SDDDEBifProblem" href="#DDEBifurcationKit.SDDDEBifProblem"><code>DDEBifurcationKit.SDDDEBifProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SDDDEBifProblem{Tvf, Tdf, Tu, Td, Tp, Tl&lt;:Union{typeof(identity), Nothing, IndexLens, PropertyLens, ComposedFunction}, Tplot, Trec, Tgets, Tδ} &lt;: DDEBifurcationKit.AbstractDDEBifurcationProblem</code></pre><p>Structure to hold the bifurcation problem. If don&#39;t have parameters, you can pass <code>nothing</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>VF::Any</code>: Vector field, typically a <a href="@ref"><code>BifFunction</code></a>. For more information, please look at the website https://bifurcationkit.github.io/DDEBifurcationKit.jl/dev/BifProblem</p></li><li><p><code>delays::Any</code>: function delays. It takes the parameters and the state and return the non-zero delays in an <code>AsbtractVector</code> form. Example: <code>delays = (par, u) -&gt; [1. + u[1]^2]</code></p></li><li><p><code>u0::Any</code>: Initial guess</p></li><li><p><code>delays0::Any</code>: initial delays (set internally by the constructor)</p></li><li><p><code>params::Any</code>: parameters</p></li><li><p><code>lens::Union{typeof(identity), Nothing, IndexLens, PropertyLens, ComposedFunction}</code>: see ConstantDDEBifProblem for more information.</p></li><li><p><code>plotSolution::Any</code>: user function to plot solutions during continuation. Signature: <code>plotSolution(x, p; kwargs...)</code></p></li><li><p><code>recordFromSolution::Any</code>: <code>record_from_solution = (x, p; k...) -&gt; norm(x)</code> function used record a few indicators about the solution. It could be <code>norm</code> or <code>(x, p) -&gt; x[1]</code>. This is also useful when saving several huge vectors is not possible for memory reasons (for example on GPU...). This function can return pretty much everything but you should keep it small. For example, you can do <code>(x, p) -&gt; (x1 = x[1], x2 = x[2], nrm = norm(x))</code> or simply <code>(x, p) -&gt; (sum(x), 1)</code>. This will be stored in <code>contres.branch</code> (see below). Finally, the first component is used to plot in the continuation curve.</p></li><li><p><code>save_solution::Any</code>: function to save the full solution on the branch. Some problem are mutable (like periodic orbit functional with adaptive mesh) and this function allows to save the state of the problem along with the solution itself. Signature <code>save_solution(x, p)</code></p></li><li><p><code>δ::Any</code>: delta for Finite differences</p></li></ul><p><strong>Methods</strong></p><ul><li><code>getu0(pb)</code> calls <code>pb.u0</code></li><li><code>getparams(pb)</code> calls <code>pb.params</code></li><li><code>getlens(pb)</code> calls <code>pb.lens</code></li><li><code>setparam(pb, p0)</code> calls <code>set(pb.params, pb.lens, p0)</code></li><li><code>record_from_solution(pb)</code> calls <code>pb.record_from_solution</code></li></ul><p><strong>Constructors</strong></p><ul><li><code>SDDDEBifProblem(F, delays, u0, params, lens; J, Jᵗ, d2F, d3F, kwargs...)</code> and <code>kwargs</code> are the fields above.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/DDEBifurcationKit.jl/blob/f71a9db0d86172ad0d8e44f83e0654ac5b8889c0/src/Problems.jl#L249">source</a></section></article><h2 id="Eigen-solvers"><a class="docs-heading-anchor" href="#Eigen-solvers">Eigen solvers</a><a id="Eigen-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Eigen-solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DDEBifurcationKit.DDE_DefaultEig" href="#DDEBifurcationKit.DDE_DefaultEig"><code>DDEBifurcationKit.DDE_DefaultEig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct DDE_DefaultEig{T, Tw, Tv} &lt;: DDEBifurcationKit.AbstractDDEEigenSolver</code></pre><p>Default eigen solver for DDEBifurcationKit based on the julia package NonlinearEigenproblems.jl. ore precisely, we rely on <code>NonlinearEigenproblems.iar_chebyshev</code> for the computation of eigenvalues.</p><p><strong>Fields</strong></p><ul><li><p><code>maxit::Int64</code>: Default: 100</p></li><li><p><code>which::Any</code>: Default: real</p></li><li><p><code>σ::Any</code>: Default: 0.0</p></li><li><p><code>γ::Any</code>: Default: 1.0</p></li><li><p><code>tol::Any</code>: Default: 1.0e-10</p></li><li><p><code>logger::Int64</code>: Default: 0</p></li><li><p><code>check_error_every::Int64</code>: Default: 1</p></li><li><p><code>v::Any</code>: Default: nothing</p></li></ul><p><strong>Constructors</strong></p><ul><li><code>DDE_DefaultEig(; kwargs...)</code> and <code>kwargs</code> are the fields above.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/DDEBifurcationKit.jl/blob/f71a9db0d86172ad0d8e44f83e0654ac5b8889c0/src/EigSolver.jl#L3">source</a></section></article><h2 id="Branch-switching-(branch-point)"><a class="docs-heading-anchor" href="#Branch-switching-(branch-point)">Branch switching (branch point)</a><a id="Branch-switching-(branch-point)-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-switching-(branch-point)" title="Permalink"></a></h2><div class="admonition is-warning" id="Missing-docstring.-f0c14fa0f2b4b4d7"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-f0c14fa0f2b4b4d7" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>continuation(br::ContResult, ind_bif::Int, optionsCont::ContinuationPar ; kwargs...)</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Branch-switching-(Hopf-point)"><a class="docs-heading-anchor" href="#Branch-switching-(Hopf-point)">Branch switching (Hopf point)</a><a id="Branch-switching-(Hopf-point)-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-switching-(Hopf-point)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BifurcationKit.continuation-Tuple{BifurcationKit.AbstractBranchResult, Int64, ContinuationPar, BifurcationKit.AbstractPeriodicOrbitProblem}" href="#BifurcationKit.continuation-Tuple{BifurcationKit.AbstractBranchResult, Int64, ContinuationPar, BifurcationKit.AbstractPeriodicOrbitProblem}"><code>BifurcationKit.continuation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">continuation(
    br,
    ind_bif,
    _contParams,
    pbPO;
    bif_prob,
    alg,
    δp,
    ampfactor,
    usedeflation,
    detailed,
    use_normal_form,
    autodiff_nf,
    nev,
    kwargs...
)
</code></pre><p>Perform automatic branch switching from a Hopf bifurcation point labelled <code>ind_bif</code> in the list of the bifurcated points of a previously computed branch <code>br::ContResult</code>. It first computes a Hopf normal form.</p><p><strong>Arguments</strong></p><ul><li><code>br</code> branch result from a call to <code>continuation</code></li><li><code>ind_hopf</code> index of the bifurcation point in <code>br</code></li><li><code>contParams</code> parameters for the call to <code>continuation</code></li><li><code>probPO</code> problem used to specify the way toc compute the periodic orbit. It can be <a href="@ref"><code>PeriodicOrbitTrapProblem</code></a>, <a href="@ref"><code>PeriodicOrbitOCollProblem</code></a>, <a href="@ref"><code>ShootingProblem</code></a> or <a href="@ref"><code>PoincareShootingProblem</code></a> .</li></ul><p><strong>Optional arguments</strong></p><ul><li><code>alg = br.alg</code> continuation algorithm</li><li><code>δp</code> used to specify the guess for the parameter on the bifurcated branch which otherwise defaults to <code>contParams.ds</code>. This allows to use an initial step larger than <code>contParams.dsmax</code>.</li><li><code>ampfactor = 1</code> multiplicative factor to alter the amplitude of the bifurcated solution. Useful to magnify the bifurcated solution when the bifurcated branch is very steep.</li><li><code>use_normal_form = true</code> whether to use the normal form in order to compute the predictor. When <code>false</code>, <code>ampfactor</code> and <code>δp</code> are used to make a predictor based on the bifurcating eigenvector. Setting <code>use_normal_form = false</code> can be useful when computing the normal form is not possible for example when higher order derivatives are not available.</li><li><code>usedeflation = true</code> whether to use nonlinear deflation (see <a href="@ref">Deflated problems</a>) to help finding the guess on the bifurcated branch</li><li><code>nev</code> number of eigenvalues to be computed to get the right eigenvector</li><li><code>autodiff_nf = true</code> whether to use <code>autodiff</code> in <code>get_normal_form</code>. This can be used in case automatic differentiation is not working as intented.</li><li>all <code>kwargs</code> from <a href="#BifurcationKit.continuation-Tuple{BifurcationKit.AbstractBranchResult, Int64, ContinuationPar, BifurcationKit.AbstractPeriodicOrbitProblem}"><code>continuation</code></a></li></ul><p>A modified version of <code>prob</code> is passed to <code>plot_solution</code> and <code>finalise_solution</code>.</p><div class="admonition is-info" id="Linear-solver-affc16ee194e585"><header class="admonition-header">Linear solver<a class="admonition-anchor" href="#Linear-solver-affc16ee194e585" title="Permalink"></a></header><div class="admonition-body"><p>You have to be careful about the options <code>contParams.newton_options.linsolver</code>. In the case of Matrix-Free solver, you have to pass the right number of unknowns <code>N * M + 1</code>. Note that the options for the preconditioner are not accessible yet.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/periodicorbit/PeriodicOrbits.jl#L365">source</a></section></article><h2 id="Utils-for-periodic-orbits"><a class="docs-heading-anchor" href="#Utils-for-periodic-orbits">Utils for periodic orbits</a><a id="Utils-for-periodic-orbits-1"></a><a class="docs-heading-anchor-permalink" href="#Utils-for-periodic-orbits" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BifurcationKit.getperiod" href="#BifurcationKit.getperiod"><code>BifurcationKit.getperiod</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getperiod(, x)
getperiod(, x, par)
</code></pre><p>Compute the period of the periodic orbit associated to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/periodicorbit/PeriodicOrbits.jl#L4">source</a></section><section><div><pre><code class="language-julia hljs">getperiod(prob, x, p)
</code></pre><p>Compute the period of the periodic orbit associated to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/periodicorbit/PeriodicOrbitTrapeze.jl#L158">source</a></section><section><div><pre><code class="language-julia hljs">getperiod(psh, x_bar, par)
</code></pre><p>Compute the period of the periodic orbit associated to <code>x_bar</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/periodicorbit/PoincareShooting.jl#L108">source</a></section></article><h2 id="Misc."><a class="docs-heading-anchor" href="#Misc.">Misc.</a><a id="Misc.-1"></a><a class="docs-heading-anchor-permalink" href="#Misc." title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BifurcationKit.get_normal_form" href="#BifurcationKit.get_normal_form"><code>BifurcationKit.get_normal_form</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_normal_form(
    prob,
    br,
    id_bif;
    nev,
    verbose,
    lens,
    Teigvec,
    scaleζ,
    detailed,
    autodiff,
    ζs,
    ζs_ad,
    bls,
    bls_adjoint,
    bls_block
)
</code></pre><p>Compute the normal form of the bifurcation point located at <code>br.specialpoint[ind_bif]</code>.</p><p><strong>Arguments</strong></p><ul><li><code>prob::AbstractBifurcationProblem</code></li><li><code>br</code> result from a call to <a href="#BifurcationKit.continuation-Tuple{BifurcationKit.AbstractBranchResult, Int64, ContinuationPar, BifurcationKit.AbstractPeriodicOrbitProblem}"><code>continuation</code></a></li><li><code>ind_bif</code> index of the bifurcation point in <code>br.specialpoint</code></li></ul><p><strong>Optional arguments</strong></p><ul><li><code>nev</code> number of eigenvalues used to compute the spectral projection. This number has to be adjusted when used with iterative methods.</li><li><code>verbose</code> whether to display information</li><li><code>ζs</code> list of vectors spanning the kernel of <code>dF</code> at the bifurcation point. Useful to enforce the basis for the normal form.</li><li><code>lens::Lens</code> specify which parameter to take the partial derivative ∂pF</li><li><code>scaleζ</code> function to normalise the kernel basis. Indeed, when used with large vectors and <code>norm</code>, it results in ζs and the normal form coefficient being super small.</li><li><code>autodiff = true</code> whether to use ForwardDiff for the differentiations w.r.t the parameters that are required to compute the normal form. Used for example for Bogdanov-Takens point. You can set to <code>autodiff = false</code> if you wish.</li><li><code>detailed = true</code> whether to compute only a simplified normal form. Used for example for Bogdanov-Takens point.</li><li><code>bls = MatrixBLS()</code> specify Bordered linear solver. Used for example for Bogdanov-Takens point.</li><li><code>bls_adjoint = bls</code> specify Bordered linear solver for the adjoint problem.</li><li><code>bls_block = bls</code> specify Bordered linear solver when the border has dimension 2 (1 for <code>bls</code>).</li></ul><p><strong>Available method</strong></p><p>You can directly call </p><pre><code class="nohighlight hljs">get_normal_form(br, ind_bif ; kwargs...)</code></pre><p>which is a shortcut for <code>get_normal_form(getprob(br), br, ind_bif ; kwargs...)</code>.</p><p>Once the normal form <code>nf</code> has been computed, you can call <code>predictor(nf, δp)</code> to obtain an estimate of the bifurcating branch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/NormalForms.jl#L458">source</a></section><section><div><pre><code class="language-julia hljs">get_normal_form(
    prob,
    br,
    id_bif;
    nev,
    verbose,
    ζs,
    lens,
    Teigvec,
    scaleζ,
    autodiff,
    δ,
    k...
)
</code></pre><p>Compute the normal form (NF) of periodic orbits. We detail the additional keyword arguments specific to periodic orbits</p><p><strong>Optional arguments</strong></p><ul><li><code>prm = true</code> compute the normal form using Poincaré return map (PRM). If false, use the Iooss normal form. </li><li><code>nev = length(eigenvalsfrombif(br, id_bif))</code>,</li><li><code>verbose = false</code>,</li><li><code>ζs = nothing</code>, pass the eigenvectors</li><li><code>lens = getlens(br)</code>,</li><li><code>Teigvec = _getvectortype(br)</code> type of the eigenvectors (can be useful for GPU)</li><li><code>scaleζ = norm</code>, scale the eigenvector</li><li><code>prm = true</code> NF based on Poincare return map (<code>prm=true</code>) or Iooss&#39; method.</li><li><code>autodiff = false</code> use autodiff or finite differences in some part of the normal form computation</li><li><code>detailed = true</code> to get detailed normal form</li><li><code>δ = getdelta(prob)</code> delta used for finite differences</li></ul><p><strong>Notes</strong></p><p>For collocation, the default method to compute the NF of Period-doubling and Neimark-Sacker bifurcations is Iooss&#39; method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bifurcationkit/BifurcationKit.jl/blob/63998a15ed672942a9f4d0c521d89e64898adaf6/src/periodicorbit/NormalForms.jl#L1">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../faq/">« Frequently Asked Questions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 13 August 2025 11:08">Wednesday 13 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
